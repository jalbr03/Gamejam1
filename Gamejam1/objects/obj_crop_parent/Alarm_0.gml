if(state < max_state) state += 1;